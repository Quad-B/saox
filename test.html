<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Mitr:wght@300&display=swap" rel="stylesheet">
    <!-- Global site tag (gtag.js) - Google Analytics >
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-40172537-11"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-40172537-11');
    </script-->
    <style>
        body {
            background-color: black;
        }
        #notification {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 200px;
            padding: 20px;
            border-radius: 5px;
            background-color: white;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
        }

        .hidden {
            display: none;
        }

        .container-after-titlebar {
            overflow: hidden !important;
            /* Hide scrollbars */
        }

        /* iframe {
            border: 0;
            width: 100%;
            height: 100%;
            margin-top: 0.4%;
        } */
    </style>
</head>

<body style="margin:0px;padding:0px;overflow:hidden">

    <div style="z-index: 1000;width:100%;height:100%;background-color: black;position: absolute;font-size: 100px;text-align: center;background-image: url(https://raw.githubusercontent.com/Quad-B/saox/master/img/saox.gif);background-position: center;background-repeat: no-repeat;" id="loadingdiv"><!--img src="https://upload.wikimedia.org/wikipedia/commons/5/54/Ajux_loader.gif" style="display: block;margin: 0 auto;"--></div>
    <iframe src="https://www.joox.com/th" id="iframe" frameborder="0" onload="updatedl()"
        style="overflow:hidden;overflow-x:hidden;overflow-y:hidden;height:100%;width:100%;position:absolute;top:0px;left:0px;right:0px;bottom:0px"
        height="100%" width="100%">
    </iframe>

    <!--div id="notification" class="hidden">
        <p id="message" style="font-family: 'Mitr', sans-serif;"></p>
        <button id="close-button" onClick="closeNotification()" class="hidden" style="font-family: 'Mitr', sans-serif;">
            ปิด
        </button>
        <button id="update-button" onClick="updateApp()" class="hidden" style="font-family: 'Mitr', sans-serif;">
            อัพเดต
        </button>
        <button id="restart-button" onClick="restartApp()" class="hidden" style="font-family: 'Mitr', sans-serif;">
            รีสตาร์
        </button>
    </div-->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"
        onload="window.$ = window.jQuery = module.exports;"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha512-z4OUqw38qNLpn1libAN9BsoDx6nbNFio5lA6CuTp9NlK83b89hgyCVq+N5FdBJptINztxn1Z3SaKSKUS5UP60Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/d3js/5.15.1/d3.min.js"></script>\
    <script src="https://chir.ag/projects/ntc/ntc.js"></script>
    <script src="https://unpkg.com/fast-average-color/dist/index.min.js"></script>

    <!--script src="js/update.js"></script-->

    <script>

        const fac = new FastAverageColor();
        /*const { app, remote, ipcRenderer, shell } = require('electron')
        const { Menu, MenuItem } = remote*/
        const { app, ipcRenderer, shell } = require('electron')
        //const remote = require('@electron/remote')
        const { Menu, MenuItem } = require('@electron/remote')
        const customTitlebar = require('custom-electron-titlebar');
        const osLocale = require('os-locale');
        let colorcustom = 'sync'
        let language = 'en'
        let sooxlogo = "joox"
        let areyouok = require('@electron/remote').app.getAppPath()
        let changelag = false
        let musicname,discordmenu

        //console.log(areyouok)

        const os = require('os');
        const storage = require('electron-json-storage');
        storage.setDataPath(os.tmpdir());

        const RPG = require('discord-rpc');
        const rpc = new RPG.Client({
            transport: "ipc"
        });

        rpc.login({
            clientId: "831916121497927731"
        });

        rpc.on("ready", () => {
        }); 

        /*storage.set('foobar', { foo: 'bar' }, function(error) {
            if (error) throw error;
        });

        storage.get('foobar', function(error, data) {
            if (error) throw error;

            console.log(data.foo);
        });*/

        /*const notification = document.getElementById('notification');
        const message = document.getElementById('message');
        const closeButton = document.getElementById('close-button')
        const restartButton = document.getElementById('restart-button');
        const updateButton = document.getElementById('update-button');

        ipcRenderer.on('update_not_available', () => {
            setTimeout(function(){ notification.classList.remove('hidden'); }, 10000);
            ipcRenderer.removeAllListeners('update_not_available');
            message.innerHTML = 'ไม่มีการอัพเดต<br>คุณติดตั้งเวอร์ชั่นล่าสุดแล้ว';
            //notification.classList.remove('hidden');
            setTimeout(function(){ notification.classList.add('hidden'); }, 10000);
        });

        ipcRenderer.on('update_available', () => {
            ipcRenderer.removeAllListeners('update_available');
            message.innerHTML = 'มีอัพเดตเวอร์ชั่นใหม่<br>กำลังอัพเดต';
            //message.innerHTML = 'มีอัพเดตเวอร์ชั่นใหม่<br>ต้องการที่จะอัพเดตไหม?';
            //closeButton.classList.remove('hidden');
            //updateButton.classList.remove('hidden');
            notification.classList.remove('hidden');
            setTimeout(function(){ notification.classList.add('hidden'); }, 7500);
        });

        ipcRenderer.on('incoming', () => {
            setTimeout(function(){ notification.classList.remove('hidden'); }, 7500);
            //closeButton.classList.add('hidden');
            //updateButton.classList.add('hidden');
        //ipcRenderer.on('incoming', function (event, data) {
            ipcRenderer.removeAllListeners('incoming');
            //message.innerText = data;
            message.innerText = 'กำลังดาว์นโหลด';
            //notification.classList.remove('hidden');
            setTimeout(function(){ notification.classList.add('hidden'); }, 7500);
        });

        ipcRenderer.on('error', () => {
            setTimeout(function(){ notification.classList.remove('hidden'); }, 7500);
            //closeButton.classList.add('hidden');
            //updateButton.classList.add('hidden');
            ipcRenderer.removeAllListeners('error');
            /*restartButton.classList.add('hidden');
            message.innerText = data;*/
        /*message.innerHTML = 'มีปัญหาในการอัพเดต <br> โปรแกรมจะทำการอัพเดตในครั้งถัดไป';
        //notification.classList.remove('hidden');
        setTimeout(function(){ notification.classList.add('hidden'); }, 7500);
        //notification.classList.add('hidden');
        });

        ipcRenderer.on('update_downloaded', () => {
            setTimeout(function(){ notification.classList.remove('hidden'); }, 10000);
            //closeButton.classList.add('hidden');
            //updateButton.classList.add('hidden');
            ipcRenderer.removeAllListeners('update_downloaded');
            //message.innerText = 'อัพเดตเสร็จแล้ว. ถ้าต้องการอัพเดตจำเป็นต้องปิดโปรแกรม อัพเดตตอนนี้เลยไหม?';
            message.innerHTML = 'ถ้าคุณเห็นข้อความนี้ <br> แสดงว่าการอัพเดตไม่สำเร็จ <br> โปรแกรมจะทำการอัพเดตในครั้งถัดไป'
            //restartButton.classList.remove('hidden');
            //notification.classList.remove('hidden');
            setTimeout(function(){ notification.classList.add('hidden'); }, 10000);
        });

        function closeNotification() {
            notification.classList.add('hidden');
        }
    
        function restartApp() {
            ipcRenderer.send('restart_app');
        }

        function updateApp() {
            ipcRenderer.send('update_app');
        }*/

        const discordacthandleClick = (menuItem, browserWindow, event) => {
            //console.log(menuItem.label)
            if (menuItem.label == 'เปิด' || menuItem.label == 'Enable') {
                storage.set('discordstatus', { status: 'on' }, function (error) {
                    if (error) throw error;
                    updatedl('notok')
                });
                if(language == 'en'){
                    discordmenu = {
                        label: 'Status In Discord',
                        submenu: [
                            {
                                label: 'Enable',
                                type: 'radio',
                                checked: true,
                                click: discordacthandleClick
                            },
                            {
                                label: 'Disable',
                                type: 'radio',
                                click: discordacthandleClick
                            }
                        ]
                    };
                }else{
                    discordmenu = {
                        label: 'สถานะในดิสคอร์ด',
                        submenu: [
                            {
                                label: 'เปิด',
                                type: 'radio',
                                checked: true,
                                click: discordacthandleClick
                            },
                            {
                                label: 'ปิด',
                                type: 'radio',
                                click: discordacthandleClick
                            }
                        ]
                    };
                }
                /*colorcustom = 'sync'

                storage.set('customcolor', { color: 'sync' }, function (error) {
                    if (error) throw error;
                });

                console.log('ok')*/
            } else {
                storage.set('discordstatus', { status: 'off' }, function (error) {
                    if (error) throw error;
                    updatedl('notok')
                });
                if(language == 'en'){
                    discordmenu = {
                        label: 'Status In Discord',
                        submenu: [
                            {
                                label: 'Enable',
                                type: 'radio',
                                click: discordacthandleClick
                            },
                            {
                                label: 'Disable',
                                type: 'radio',
                                checked: true,
                                click: discordacthandleClick
                            }
                        ]
                    };
                }else{
                    discordmenu = {
                        label: 'สถานะในดิสคอร์ด',
                        submenu: [
                            {
                                label: 'เปิด',
                                type: 'radio',
                                click: discordacthandleClick
                            },
                            {
                                label: 'ปิด',
                                type: 'radio',
                                checked: true,
                                click: discordacthandleClick
                            }
                        ]
                    };
                }
                /*colorcustom = 'dark'

                storage.set('customcolor', { color: 'dark' }, function (error) {
                    if (error) throw error;
                });

                console.log('ok')*/
            }
            /*if (document.title == 'SAOX') {
                updatedl('notok')
            } else {
                updatedl('ok')
            }*/
            //updatedl('changecolor')
            //console.log('ok')
        }

        const changecolorhandleClick = (menuItem, browserWindow, event) => {
            //console.log(menuItem.label)
            if (menuItem.label == 'Sync by Music thumbnail' || menuItem.label == 'ซิงค์ตามภาพขนาดย่อของเพลง') {
                colorcustom = 'sync'

                storage.set('customcolor', { color: 'sync' }, function (error) {
                    if (error) throw error;
                });

                //console.log('ok')
            } else {
                colorcustom = 'dark'

                storage.set('customcolor', { color: 'dark' }, function (error) {
                    if (error) throw error;
                });

                //console.log('ok')
            }
            /*if (document.title == 'SAOX') {
                updatedl('notok')
            } else {
                updatedl('ok')
            }*/
            updatedl('changecolor')
            //console.log('ok')
        }

        const handleClick = (menuItem, browserWindow, event) => {
            //console.log(menuItem.label)
            if (menuItem.label == 'English' || menuItem.label == 'อังกฤษ') {
                language = 'en'
                //console.log(language)
            } else {
                language = 'th'
                //console.log(language)
            }
            changelag = true
            if (document.title == 'SAOX') {
                updatedl('notok')
            } else {
                //updatedl('changelag')
                updatedl('ok')
            }
            //console.log('ok')
        }

        function hexToRgbA(hex) {
            var c;
            if (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {
                c = hex.substring(1).split('');
                if (c.length == 3) {
                    c = [c[0], c[0], c[1], c[1], c[2], c[2]];
                }
                c = '0x' + c.join('');
                return 'rgba(' + [(c >> 16) & 255, (c >> 8) & 255, c & 255].join(',') + ',1)';
            }
            throw new Error('Bad Hex');
        }

        let MyTitleBar = new customTitlebar.Titlebar({
            backgroundColor: customTitlebar.Color.fromHex('#444'),
            icon: 'img/saoxnew.svg',
            onMinimize: () => ipcRenderer.send('window-minimize'),
            onMaximize: () => ipcRenderer.send('window-maximize'),
            onClose: () => ipcRenderer.send('window-close'),
            isMaximized: () => ipcRenderer.sendSync('window-is-maximized')
        });

        const isMac = process.platform === 'darwin'
        
        require('electron').ipcRenderer.on('media-key', (event, message) => {
            if (message == "MediaPlayPause") {
                if (iframe.contentWindow.document.getElementById("jooxAudio").paused == true) {
                    iframe.contentWindow.document.getElementById("jooxAudio").play()
                    iframe.contentWindow.document.querySelector('.YCPsB').innerHTML = "<small>หยุด</small><i class=\"playerIcon playerIcon--pause\"></i>"
                    ipcRenderer.send('play');
                } else {
                    iframe.contentWindow.document.getElementById("jooxAudio").pause()
                    iframe.contentWindow.document.querySelector('.YCPsB').innerHTML = "<small>เล่น</small><i class=\"playerIcon playerIcon--play\"></i>"
                    ipcRenderer.send('pause');
                }
                setTimeout(checkplay(), 1000)
            }
            if (message == "Prev") {
                iframe.contentWindow.document.querySelectorAll('.ilQaFf')[0].click()
                setTimeout(checkplay(), 1000)
            }
            if (message == "Next") {
                iframe.contentWindow.document.querySelectorAll('.ilQaFf')[1].click()
                setTimeout(checkplay(), 1000)
            }
        })

        function checkplay() {
            try {
                if (iframe.contentWindow.document.getElementById("jooxAudio").paused == true) {
                    ipcRenderer.send('pause');
                } else {
                    ipcRenderer.send('play');
                }
            } catch (error) {
                ipcRenderer.send('pause');
            }
        }

        var data = storage.getSync('customcolor');
        if (data != undefined) {
            colorcustom = data.color;
        }
        //alert(data.color);

        /*storage.get('customcolor', function(error, data) {
            if (error) throw error;

            //console.log(data.foo);

            colorcustom = data.color

            if (document.title == 'SAOX') {
                updatedl('notok')
            } else {
                updatedl('ok')
            }

        });*/

        const menu = new Menu();

        if (language == 'en') {
            menu.append(new MenuItem({
                label: 'File',
                submenu: [
                    {
                        label: 'Exit/Close',
                        click: async () => {
                            window.close();
                        }
                    }
                ]
            }));

            if (colorcustom == 'sync') {
                menu.append(new MenuItem({
                    label: 'Settings',
                    submenu: [
                        {
                            label: 'Select Languages',
                            submenu: [
                                {
                                    label: 'Thai',
                                    type: 'radio',
                                    click: handleClick
                                },
                                {
                                    label: 'English',
                                    type: 'radio',
                                    checked: true,
                                    click: handleClick
                                },
                                {
                                    label: 'More Soon...'
                                }
                            ]
                        },
                        {
                            label: 'UI/Menu Color',
                            submenu: [
                                {
                                    label: 'Sync by Music thumbnail',
                                    type: 'radio',
                                    checked: true,
                                    click: changecolorhandleClick
                                },
                                {
                                    label: 'Dark / Default',
                                    type: 'radio',
                                    click: changecolorhandleClick
                                }
                            ]
                        },
                        {
                            label: 'Status In Discord',
                            submenu: [
                                {
                                    label: 'Enable',
                                    type: 'radio',
                                    checked: true,
                                    click: discordacthandleClick
                                },
                                {
                                    label: 'Disable',
                                    type: 'radio',
                                    click: discordacthandleClick
                                }
                            ]
                        }
                    ]
                }));
            } else {
                menu.append(new MenuItem({
                    label: 'Settings',
                    submenu: [
                        {
                            label: 'Select Languages',
                            submenu: [
                                {
                                    label: 'Thai',
                                    type: 'radio',
                                    click: handleClick
                                },
                                {
                                    label: 'English',
                                    type: 'radio',
                                    checked: true,
                                    click: handleClick
                                },
                                {
                                    label: 'More Soon...'
                                }
                            ]
                        },
                        {
                            label: 'UI/Menu Color',
                            submenu: [
                                {
                                    label: 'Sync by Music thumbnail',
                                    type: 'radio',
                                    click: changecolorhandleClick
                                },
                                {
                                    label: 'Dark / Default',
                                    type: 'radio',
                                    checked: true,
                                    click: changecolorhandleClick
                                }
                            ]
                        },
                        {
                            label: 'Status In Discord',
                            submenu: [
                                {
                                    label: 'Enable',
                                    type: 'radio',
                                    checked: true,
                                    click: discordacthandleClick
                                },
                                {
                                    label: 'Disable',
                                    type: 'radio',
                                    click: discordacthandleClick
                                }
                            ]
                        }
                    ]
                }));
            }

            if (require('@electron/remote').app.isPackaged == true && areyouok.toLowerCase().includes('temp') != true && areyouok.toLowerCase().includes('snap') != true) {
                menu.append(new MenuItem({
                    label: 'Help',
                    submenu: [
                        {
                            label: 'Follow Us',
                            click: async () => {
                                const { shell } = require('electron')
                                await shell.openExternal('https://www.facebook.com/QuadBCoder/')
                            }
                        },
                        {
                            label: 'Buy me a ko-fi',
                            click: async () => {
                                const { shell } = require('electron')
                                await shell.openExternal('https://ko-fi.com/boyphongsakorn')
                            }
                        },
                        { type: 'separator' },
                        {
                            label: 'Report Bug/Issue',
                            click: async () => {
                                const { shell } = require('electron')
                                await shell.openExternal('https://github.com/boyphongsakorn/saox/issues')
                            }
                        },
                        {
                            label: 'Discord Support/Report',
                            click: async () => {
                                await shell.openExternal('https://discord.gg/j7xce5hxUf')
                            }
                        },
                        { type: 'separator' },
                        {
                            label: 'About SAOX',
                            click: async () => {
                                const { shell } = require('electron')
                                await shell.openExternal('https://quad-b.github.io/saox/')
                            }
                        },
                        {
                            label: 'Check for update...',
                            click: async () => {
                                ipcRenderer.send('checkdamnupdate');
                            }
                        },
                        {
                            label: 'Force update (Not recommend to use)',
                            click: async () => {
                                ipcRenderer.send('tryquitandupdate');
                            }
                        },
                        {
                            label: 'SAOX Version ' + require('@electron/remote').app.getVersion(),
                            click: async () => {
                                //var remote = require("remote");
                                //var BrowserWindow = remote.require("browser-window");
                                var BrowserWindow = require('@electron/remote').BrowserWindow;
                                var windows = BrowserWindow.getFocusedWindow();

                                // Look for the popup window and then...
                                windows.openDevTools();
                            }
                        }
                    ]
                }));
            } else {
                menu.append(new MenuItem({
                    label: 'Help',
                    submenu: [
                        {
                            label: 'Follow Us',
                            click: async () => {
                                const { shell } = require('electron')
                                await shell.openExternal('https://www.facebook.com/QuadBCoder/')
                            }
                        },
                        {
                            label: 'Buy me a ko-fi',
                            click: async () => {
                                const { shell } = require('electron')
                                await shell.openExternal('https://ko-fi.com/boyphongsakorn')
                            }
                        },
                        { type: 'separator' },
                        {
                            label: 'Report Bug/Issue',
                            click: async () => {
                                const { shell } = require('electron')
                                await shell.openExternal('https://github.com/boyphongsakorn/saox/issues')
                            }
                        },
                        {
                            label: 'Discord Support/Report',
                            click: async () => {
                                await shell.openExternal('https://discord.gg/j7xce5hxUf')
                            }
                        },
                        { type: 'separator' },
                        {
                            label: 'About SAOX',
                            click: async () => {
                                const { shell } = require('electron')
                                await shell.openExternal('https://quad-b.github.io/saox/')
                            }
                        },
                        {
                            label: 'SAOX Version ' + require('@electron/remote').app.getVersion(),
                            click: async () => {
                                //var remote = require("remote");
                                //var BrowserWindow = remote.require("browser-window");
                                var BrowserWindow = require('@electron/remote').BrowserWindow;
                                var windows = BrowserWindow.getFocusedWindow();

                                // Look for the popup window and then...
                                windows.openDevTools();
                            }
                        }
                    ]
                }));
            }
        } else {
            menu.append(new MenuItem({
                label: 'เมนูหลัก',
                submenu: [
                    {
                        label: 'ปิดโปรแกรม',
                        click: async () => {
                            window.close();
                        }
                    }
                ]
            }));

            if (colorcustom == 'sync') {
                menu.append(new MenuItem({
                    label: 'ตั้งค่า',
                    submenu: [
                        {
                            label: 'ภาษา',
                            submenu: [
                                {
                                    label: 'ไทย',
                                    type: 'radio',
                                    checked: true,
                                    click: handleClick
                                },
                                {
                                    label: 'อังกฤษ',
                                    type: 'radio',
                                    click: handleClick
                                }
                            ]
                        },
                        {//#111111
                            label: 'สีของเมนู',
                            submenu: [
                                {
                                    label: 'ซิงค์ตามภาพขนาดย่อของเพลง',
                                    type: 'radio',
                                    checked: true,
                                    click: changecolorhandleClick
                                },
                                {
                                    label: 'สีดำ',
                                    type: 'radio',
                                    click: changecolorhandleClick
                                }
                            ]
                        },
                        {
                            label: 'สถานะในดิสคอร์ด',
                            submenu: [
                                {
                                    label: 'เปิด',
                                    type: 'radio',
                                    checked: true,
                                    click: discordacthandleClick
                                },
                                {
                                    label: 'ปิด',
                                    type: 'radio',
                                    click: discordacthandleClick
                                }
                            ]
                        }
                    ]
                }));
            } else {
                menu.append(new MenuItem({
                    label: 'ตั้งค่า',
                    submenu: [
                        {
                            label: 'ภาษา',
                            submenu: [
                                {
                                    label: 'ไทย',
                                    type: 'radio',
                                    checked: true,
                                    click: handleClick
                                },
                                {
                                    label: 'อังกฤษ',
                                    type: 'radio',
                                    click: handleClick
                                }
                            ]
                        },
                        {//#111111
                            label: 'สีของเมนู',
                            submenu: [
                                {
                                    label: 'ซิงค์ตามภาพขนาดย่อของเพลง',
                                    type: 'radio',
                                    click: changecolorhandleClick
                                },
                                {
                                    label: 'สีดำ',
                                    type: 'radio',
                                    checked: true,
                                    click: changecolorhandleClick
                                }
                            ]
                        },
                        {
                            label: 'สถานะในดิสคอร์ด',
                            submenu: [
                                {
                                    label: 'เปิด',
                                    type: 'radio',
                                    checked: true,
                                    click: discordacthandleClick
                                },
                                {
                                    label: 'ปิด',
                                    type: 'radio',
                                    click: discordacthandleClick
                                }
                            ]
                        }
                    ]
                }));
            }

            if (require('@electron/remote').app.isPackaged == true && areyouok.toLowerCase().includes('temp') != true && areyouok.toLowerCase().includes('snap') != true) {
                menu.append(new MenuItem({
                    label: 'ช่วยเหลือ',
                    submenu: [
                        {
                            label: 'ติดตาม เฟสบุ๊ค',
                            click: async () => {
                                const { shell } = require('electron')
                                await shell.openExternal('https://www.facebook.com/QuadBCoder/')
                            }
                        },
                        {
                            label: 'สนับสนุน',
                            click: async () => {
                                const { shell } = require('electron')
                                await shell.openExternal('https://ko-fi.com/boyphongsakorn')
                            }
                        },
                        { type: 'separator' },
                        {
                            label: 'แจ้ง Bug',
                            click: async () => {
                                const { shell } = require('electron')
                                await shell.openExternal('https://github.com/boyphongsakorn/saox/issues')
                            }
                        },
                        {
                            label: 'ดิสคอร์ดสำหรับแจ้งปัญหา',
                            click: async () => {
                                await shell.openExternal('https://discord.gg/j7xce5hxUf')
                            }
                        },
                        { type: 'separator' },
                        {
                            label: 'เกี่ยวกับ SAOX',
                            click: async () => {
                                const { shell } = require('electron')
                                await shell.openExternal('https://quad-b.github.io/saox/')
                            }
                        },
                        {
                            label: 'ตรวจหาการอัปเดต',
                            click: async () => {
                                ipcRenderer.send('checkdamnupdate');
                            }
                        },
                        {
                            label: 'บังคับอัพเดต (ไม่แนะนำให้ใช้)',
                            click: async () => {
                                ipcRenderer.send('tryquitandupdate');
                            }
                        },
                        { label: 'SAOX เวอร์ชั่น ' + require('@electron/remote').app.getVersion() }
                    ]
                }));
            } else {
                menu.append(new MenuItem({
                    label: 'ช่วยเหลือ',
                    submenu: [
                        {
                            label: 'ติดตาม เฟสบุ๊ค',
                            click: async () => {
                                const { shell } = require('electron')
                                await shell.openExternal('https://www.facebook.com/QuadBCoder/')
                            }
                        },
                        {
                            label: 'สนับสนุน',
                            click: async () => {
                                const { shell } = require('electron')
                                await shell.openExternal('https://ko-fi.com/boyphongsakorn')
                            }
                        },
                        { type: 'separator' },
                        {
                            label: 'แจ้ง Bug',
                            click: async () => {
                                const { shell } = require('electron')
                                await shell.openExternal('https://github.com/boyphongsakorn/saox/issues')
                            }
                        },
                        {
                            label: 'ดิสคอร์ดสำหรับแจ้งปัญหา',
                            click: async () => {
                                await shell.openExternal('https://discord.gg/j7xce5hxUf')
                            }
                        },
                        { type: 'separator' },
                        {
                            label: 'เกี่ยวกับ SAOX',
                            click: async () => {
                                const { shell } = require('electron')
                                await shell.openExternal('https://quad-b.github.io/saox/')
                            }
                        },
                        { label: 'SAOX เวอร์ชั่น ' + require('@electron/remote').app.getVersion() }
                    ]
                }));
            }
        }

        MyTitleBar.updateMenu(menu);

        MyTitleBar.updateTitle('SAOX');

        //Menu.setApplicationMenu(menu)

        document.title = 'SAOX'

        /*setInterval(function () {

            updatedl('notok')
            console.log('test')

        }, 5000);*/

        window.onload = function () {
            var oFrame = document.getElementById("iframe");
            oFrame.contentWindow.document.onmouseup = function () {
                //alert("frame contents clicked");
                //alert(oFrame.contentWindow.location.href)
                setTimeout(
                    function () {
                        //document.getElementById('div1').style.display='none';
                        //document.getElementById('div2').style.display='none';
                        if (oFrame.contentWindow.location.href.includes('vip')) {
                            shell.openExternal(oFrame.contentWindow.location.href)
                            oFrame.contentWindow.history.back()
                        }
                    }, 500);
                /*if (oFrame.contentWindow.location.href.includes('vip')) {
                    shell.openExternal(oFrame.contentWindow.location.href)
                    oFrame.contentWindow.history.back()
                }*/
            };
        };

        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition);
        } else {
            //console.log('Geolocation is not supported by this browser.')
        }

        function showPosition(position) {

            $.getJSON("https://api.longdo.com/map/services/address?lon=" + position.coords.longitude + "&lat=" + position.coords.latitude + "&noelevation=1&key=dd60afa68aa84ff6eb5e4da05044eea4", function (json) {

                if (json.country == "ประเทศไทย") {
                    (async () => {
                        //console.log(await osLocale());
                        if (await osLocale() == 'th-TH' || await osLocale() == 'th') {
                            language = 'th'
                            if (document.title == 'SAOX') {
                                updatedl('notok')
                            } else {
                                updatedl('ok')
                            }
                        } else {
                            language = 'en'
                            if (document.title == 'SAOX') {
                                updatedl('notok')
                            } else {
                                updatedl('ok')
                            }
                        }
                    })();
                }

            });

        }

        function myFunction() {
            updatedl('notok')
            if (iframe.contentWindow.document.getElementById("jooxAudio").paused == true) {
                    iframe.contentWindow.document.querySelector('.YCPsB').innerHTML = "<small>เล่น</small><i class=\"playerIcon playerIcon--play\"></i>"
                    //ipcRenderer.send('pause');
            } else {
                    iframe.contentWindow.document.querySelector('.YCPsB').innerHTML = "<small>หยุด</small><i class=\"playerIcon playerIcon--pause\"></i>"
                    //ipcRenderer.send('play');
            }
            //console.log('test')
        }

        $('iframe').on('load', function() {
            anime({
                targets: '#loadingdiv',
                opacity: 0,
                duration: 500,
                easing: 'linear',
                direction: 'alternate',
                loop: false,
                complete: function(anim) {
                    document.getElementById('loadingdiv').style.display = 'none';
                }
            })

            // Get the video element with id="myVideo"
            var vid = iframe.contentWindow.document.getElementById("jooxAudio");

            // Assign an ontimeupdate event to the video element, and execute a function if the current playback position has changed
            vid.onplaying = function() {myFunction()};
            vid.onpause = function() {myFunction()};

            iframe.contentWindow.document.querySelector('.YCPsB').addEventListener("click", function() {
                //alert(iframe.contentWindow.document.querySelector('.YCPsB').innerText)
                if(iframe.contentWindow.document.querySelector('.YCPsB').innerText == "เล่น"){
                    if (iframe.contentWindow.document.getElementById("jooxAudio").paused == true) {
                        iframe.contentWindow.document.getElementById("jooxAudio").play()
                        iframe.contentWindow.document.querySelector('.YCPsB').innerHTML = "<small>หยุด</small><i class=\"playerIcon playerIcon--pause\"></i>"
                    }
                    /*iframe.contentWindow.document.getElementById("jooxAudio").pause()
                    iframe.contentWindow.document.getElementById("jooxAudio").play()*/
                }
            });

        });

        $('#iframe').on(function () {
            anime({
                targets: '#loadingdiv',
                opacity: 0,
                duration: 500,
                easing: 'linear',
                direction: 'alternate',
                loop: false,
                complete: function(anim) {
                    document.getElementById('loadingdiv').style.display = 'none';
                }
            })
        });

        function updatedl(ok) {

            var data = storage.getSync('discordstatus');
            if (data.status == 'on') {
                if(language == 'en'){
                    discordmenu = {
                        label: 'Status In Discord',
                        submenu: [
                            {
                                label: 'Enable',
                                type: 'radio',
                                checked: true,
                                click: discordacthandleClick
                            },
                            {
                                label: 'Disable',
                                type: 'radio',
                                click: discordacthandleClick
                            }
                        ]
                    };
                }else{
                    discordmenu = {
                        label: 'สถานะในดิสคอร์ด',
                        submenu: [
                            {
                                label: 'เปิด',
                                type: 'radio',
                                checked: true,
                                click: discordacthandleClick
                            },
                            {
                                label: 'ปิด',
                                type: 'radio',
                                click: discordacthandleClick
                            }
                        ]
                    };
                }
            }else{
                if(language == 'en'){
                    discordmenu = {
                        label: 'Status In Discord',
                        submenu: [
                            {
                                label: 'Enable',
                                type: 'radio',
                                click: discordacthandleClick
                            },
                            {
                                label: 'Disable',
                                type: 'radio',
                                checked: true,
                                click: discordacthandleClick
                            }
                        ]
                    };
                }else{
                    discordmenu = {
                        label: 'สถานะในดิสคอร์ด',
                        submenu: [
                            {
                                label: 'เปิด',
                                type: 'radio',
                                click: discordacthandleClick
                            },
                            {
                                label: 'ปิด',
                                type: 'radio',
                                checked: true,
                                click: discordacthandleClick
                            }
                        ]
                    };
                }
            }

            checkplay()

            const menu = new Menu();
            var elmnt
            var image
            var art

            if (iframe.contentWindow.document.getElementsByClassName("sc-iAyFgw")[0] != null) {
                elmnt = iframe.contentWindow.document.getElementsByClassName("sc-iAyFgw")[0].innerText;
            }

            if (iframe.contentWindow.document.getElementsByClassName("sc-iRbamj")[0] != null) {
                image = iframe.contentWindow.document.getElementsByClassName("sc-iRbamj")[0].src;
            }

            if (iframe.contentWindow.document.getElementsByClassName("sc-hSdWYo")[0] != null) {
                art = iframe.contentWindow.document.getElementsByClassName("sc-hSdWYo")[0].innerHTML;
            }

            if (iframe.contentWindow.document.querySelector(".lang.current") != null){
                if(iframe.contentWindow.document.querySelector(".lang.current").innerText == "English"){
                    language = "en";
                }else{
                    language = "th";
                }
            }

            if (ok == "notok" && image != null) {
                if (!image.includes("default-album@300.png")) {
                    ok = "ok"

                    let nearart = art.replaceAll("</a><a>", ",")
                    nearart = nearart.replaceAll("<a>", "")
                    nearart = nearart.replaceAll("</a>", "")
                
                    /*const arr = iframe.contentWindow.document.getElementsByClassName("sc-dnqmqq")[0].innerText.split(":"); // splitting the string by colon
                    console.log(arr)*/
                    let seconds = iframe.contentWindow.document.getElementById("jooxAudio").duration
                    /*if(arr.length == 2) {
                        seconds = parseInt((arr[0]*60))+parseInt(arr[1]);
                    }

                    const arrtwo = iframe.contentWindow.document.getElementsByClassName("sc-htoDjs")[0].innerText.split(":"); // splitting the string by colon
                    console.log(arrtwo)*/
                    let secondstwo = iframe.contentWindow.document.getElementById("jooxAudio").currentTime
                    /*if(arrtwo.length == 2) {
                        secondstwo = parseInt((arrtwo[0]*60))+parseInt(arrtwo[1]);
                    }*/

                    seconds = seconds - secondstwo;

                    /*let milliseconds= seconds * 1000; // 10 seconds = 10000 milliseconds
                    let timeObject = new Date(timeObject.getTime() + milliseconds);*/

                    d = new Date();
                    //alert(d.getMinutes() + ':' + d.getSeconds()); //11:55
                    d.setSeconds(d.getSeconds() + parseInt(seconds));
                    //alert(d.getMinutes() + ':' + padLeadingZeros(d.getSeconds(),2)); //12:05

                    const wordToHex = ["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgrey","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgrey","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"];

                    //alert(sooxlogo)
                    
                    if(sooxlogo.split(" ").length > 1){
                        let thewarbeing = sooxlogo.split(" ");
                        let allway
                        thewarbeing.forEach(element => {
                            if(wordToHex.find(inelement => inelement == element)){
                                sooxlogo = element.toLowerCase()
                                //alert(sooxlogo)
                                allway = true
                                return true
                            }else{
                                allway = false
                            }
                        });
                        //alert(sooxlogo)
                        if(allway == false){
                            sooxlogo = "joox"
                        }
                    }else{
                        if(!wordToHex.find(element => element == sooxlogo)){
                            sooxlogo = "joox"
                        }
                    }

                    //alert(sooxlogo)

                    if(storage.getSync('discordstatus').status == 'on' && iframe.contentWindow.document.getElementById("jooxAudio").paused != true){
                        if (language == 'en') {
                            try {
                                rpc.setActivity({
                                    details: "Listening "+elmnt,
                                    state: nearart,
                                    startTimestamp: new Date(),
                                    endTimestamp: d,
                                    largeImageKey: sooxlogo,
                                    largeImageText: ""+elmnt,
                                    smallImageKey: sooxlogo,
                                    smallImageText: ""+nearart
                                });
                            } catch (error) {
                                    
                            }
                        }else{
                            try {
                                rpc.setActivity({
                                    details: "กำลังฟัง "+elmnt,
                                    state: nearart,
                                    startTimestamp: new Date(),
                                    endTimestamp: d,
                                    largeImageKey: sooxlogo,
                                    largeImageText: ""+elmnt,
                                    smallImageKey: sooxlogo,
                                    smallImageText: ""+nearart
                                });
                            } catch (error) {
                                    
                            }
                        }
                    }else{
                        try {
                            rpc.clearActivity();
                        } catch (error) {
                            
                        }
                    }
                }
            }

            if (ok == "changecolor" && iframe.contentWindow.document.getElementsByClassName("sc-iRbamj")[0] != null) {
                //$.get('https://pwisetthon.com/getcolor.php?url=' + image,  // url
                    //function (data, textStatus, jqXHR) {  // success callback
                    fac.getColorAsync(image)
                    .then(color => {
                        let data = color.hex
                        //container.style.backgroundColor = color.rgba;
                        //container.style.color = color.isDark ? '#fff' : '#000';

                        //console.log('Average color', color);
                        
                        let nearart = art.replaceAll("</a><a>", ",")
                        nearart = nearart.replaceAll("<a>", "")
                        nearart = nearart.replaceAll("</a>", "")
                        document.title = nearart + ' : ' + elmnt
                        //iframe.contentWindow.document.getElementsByClassName('MainHeader')[0].style.backgroundColor = data
                        //iframe.contentWindow.document.getElementsByClassName('MainHeader')[0].style.filter = 'brightness(50%)'
                        if (colorcustom == 'sync') {
                            var n_match = ntc.name(data);
                            /*n_rgb = n_match[0]; // RGB value of closest match
                            n_name = n_match[1]; // Text string: Color name
                            n_exactmatch = n_match[2]; // True if exact color match*/
                            //alert(n_match);
                            sooxlogo = n_match[1].toLowerCase();
                            updatedl('notok')
                            MyTitleBar.updateBackground(customTitlebar.Color.fromHex(data));
                            let test = hexToRgbA(data)
                            let okithing = test.replace(/[\d\.]+\)$/g, "0.5")
                            //iframe.contentWindow.document.getElementsByClassName('sidebar')[0].style.backgroundColor = okithing
                            var frm = frames['iframe'].contentWindow.document;
                            var otherhead = frm.getElementsByTagName("head")[0];
                            var link = frm.createElement("style");
                            link.setAttribute("type", "text/css");
                            link.innerHTML = '.ScrollbarsCustom-Thumb{background: ' + data + ' !important;} .sidebar{background-color: ' + okithing + ') !important;} .MainHeader{background-color: ' + data + ' !important;}';
                            otherhead.appendChild(link);
                        } else {
                            sooxlogo = "joox";
                            MyTitleBar.updateBackground(customTitlebar.Color.fromHex('#111111'));
                            let test = hexToRgbA('#111111')
                            let okithing = test.replace(/[\d\.]+\)$/g, "1")
                            //iframe.contentWindow.document.getElementsByClassName('sidebar')[0].style.backgroundColor = okithing
                            var frm = frames['iframe'].contentWindow.document;
                            var otherhead = frm.getElementsByTagName("head")[0];
                            var link = frm.createElement("style");
                            link.setAttribute("type", "text/css");
                            link.innerHTML = '.ScrollbarsCustom-Thumb{background: #111111 !important;} .sidebar{background-color: ' + okithing + ') !important;} .MainHeader{background-color: #111111 !important;}';
                            otherhead.appendChild(link);
                        }
                        MyTitleBar.updateTitle(nearart + ' : ' + elmnt);
                        /*if (iframe.contentWindow.document.getElementById('menuzero') || iframe.contentWindow.document.getElementById('menuone')) {
                            iframe.contentWindow.document.getElementById('menuzero').style.background = data
                            iframe.contentWindow.document.getElementById('menuone').style.background = data
                            iframe.contentWindow.document.getElementById('menuzero').style.borderRadius = '6px'
                            iframe.contentWindow.document.getElementById('menuone').style.borderRadius = '6px'
                        } else {
                            iframe.contentWindow.document.getElementsByClassName('ScrollbarsCustom-Thumb ScrollbarsCustom-ThumbY')[0].style.background = data
                            iframe.contentWindow.document.getElementsByClassName('ScrollbarsCustom-Thumb ScrollbarsCustom-ThumbY')[0].id = 'menuzero'
                            iframe.contentWindow.document.getElementsByClassName('ScrollbarsCustom-Thumb ScrollbarsCustom-ThumbY')[0].className = ''
                            iframe.contentWindow.document.getElementsByClassName('ScrollbarsCustom-Thumb ScrollbarsCustom-ThumbY')[0].style.background = data
                            iframe.contentWindow.document.getElementsByClassName('ScrollbarsCustom-Thumb ScrollbarsCustom-ThumbY')[0].id = 'menuone'
                            iframe.contentWindow.document.getElementsByClassName('ScrollbarsCustom-Thumb ScrollbarsCustom-ThumbY')[0].className = ''
                        }*/
                        //console.log(iframe.contentWindow.document.getElementsByClassName('ScrollbarsCustom-Thumb ScrollbarsCustom-ThumbY')[1].style.background = data)
                        //iframe.contentWindow.document.getElementsByClassName('ScrollbarsCustom-Thumb ScrollbarsCustom-ThumbY')[0].className = ''
                        // console.log(iframe.contentWindow.document.getElementsByClassName('ScrollbarsCustom-Thumb ScrollbarsCustom-ThumbY')[1].style.background = data)
                    })
                    .catch(e => {
                        //console.log(e);
                    });
                //});
            }

            if (ok == "ok" && (musicname != elmnt || changelag == true)) {
                //console.log("wow")
                musicname = iframe.contentWindow.document.getElementsByClassName("sc-iAyFgw")[0].innerText
                changelag = false

                let nearart = art.replaceAll("</a><a>", ",")
                nearart = nearart.replaceAll("<a>", "")
                nearart = nearart.replaceAll("</a>", "")

                iframe.contentWindow.document.getElementsByClassName('sc-bwzfXH fHRtps')[0].style.backgroundImage = ""

                var requestOptions = {
                    method: 'GET',
                    redirect: 'follow'
                };

                fetch("https://ytgif.pwisetthon.com/?name="+elmnt+"&art="+nearart, requestOptions)
                .then(response => response.text())
                .then(result => {
                    //console.log(result)
                    //alert(elmnt)
                    //alert(nearart)
                    //alert(result)
                    if(result != ""){
                        iframe.contentWindow.document.getElementsByClassName('sc-bwzfXH fHRtps')[0].style.backgroundImage = "url("+result+")"
                        iframe.contentWindow.document.getElementsByClassName('sc-bwzfXH fHRtps')[0].style.backgroundPosition = "top"
                        iframe.contentWindow.document.getElementsByClassName('sc-bwzfXH fHRtps')[0].style.backgroundRepeat = "no-repeat"
                        iframe.contentWindow.document.getElementsByClassName('sc-bwzfXH fHRtps')[0].style.backgroundSize = "cover"
                        iframe.contentWindow.document.getElementsByClassName('sc-bwzfXH fHRtps')[0].style.filter = "brightness(0.5)"
                    }
                })
                .catch(error => console.log('error', error));

                function padLeadingZeros(num, size) {
                    var s = num + "";
                    while (s.length < size) s = "0" + s;
                    return s;
                }

                //console.log(language)
                if (language == 'en') {

                    try {
                        iframe.contentWindow.document.getElementById("watchonyoutube").outerHTML = "";
                    } catch (error) {

                    }
                    var div = document.createElement('div');
                    div.id = 'watchonyoutube';
                    div.innerHTML = '<div type="mini" class="sc-ckVGcZ fYXjSb"><a href="https://www.youtube.com/results?search_query=' + nearart + '%20' + elmnt + '&sp=CAM%253D' + '" target="_blank"><button font-size="1.3em" class="jHhvsM"><small>Watch This Music Video On Youtube</small><img src="https://boyphongsakorn.github.io/img/output-onlinepngtools.png"></button></a></div>';
                    div.className = 'sc-cvbbAY jRxSQj';

                    iframe.contentWindow.document.getElementsByClassName("sc-eHgmQL")[0].appendChild(div);
                    //iframe.contentWindow.document.getElementsByClassName("sc-kEYyzF")[0].innerHTML += "<div class=\"sc-cvbbAY jRxSQj\" id=\"watchonyoutube\"><div type=\"mini\" class=\"sc-ckVGcZ fYXjSb\"><a href=\"https://www.youtube.com/results?search_query=" + nearart + elmnt + '&sp=CAM%253D'+"\" target=\"_blank\"><button font-size=\"1.3em\" class=\"jHhvsM\"><small>Watch This Music Video On Youtube</small><img src=\"https://boyphongsakorn.github.io/img/output-onlinepngtools.png\"></button></a></div></div>"

                    menu.append(new MenuItem({
                        label: 'File',
                        submenu: [
                            {
                                label: 'Watch This Music Video on YouTube',
                                click: async () => {
                                    const { shell } = require('electron')
                                    await shell.openExternal('https://www.youtube.com/results?search_query=' + nearart + '%20' + elmnt + '&sp=CAM%253D')
                                }
                            },
                            {
                                label: 'Exit/Close',
                                click: async () => {
                                    window.close();
                                }
                            }
                        ]
                    }));

                    if (colorcustom == 'sync') {
                        menu.append(new MenuItem({
                            label: 'Settings',
                            submenu: [
                                {
                                    label: 'Select Languages',
                                    submenu: [
                                        {
                                            label: 'Thai',
                                            type: 'radio',
                                            click: handleClick
                                        },
                                        {
                                            label: 'English',
                                            type: 'radio',
                                            checked: true,
                                            click: handleClick
                                        },
                                        {
                                            label: 'More Soon...'
                                        }
                                    ]
                                },
                                {
                                    label: 'UI/Menu Color',
                                    submenu: [
                                        {
                                            label: 'Sync by Music thumbnail',
                                            type: 'radio',
                                            checked: true,
                                            click: changecolorhandleClick
                                        },
                                        {
                                            label: 'Dark / Default',
                                            type: 'radio',
                                            click: changecolorhandleClick
                                        }
                                    ]
                                },discordmenu
                            ]
                        }));
                    } else {
                        menu.append(new MenuItem({
                            label: 'Settings',
                            submenu: [
                                {
                                    label: 'Select Languages',
                                    submenu: [
                                        {
                                            label: 'Thai',
                                            type: 'radio',
                                            click: handleClick
                                        },
                                        {
                                            label: 'English',
                                            type: 'radio',
                                            checked: true,
                                            click: handleClick
                                        },
                                        {
                                            label: 'More Soon...'
                                        }
                                    ]
                                },
                                {
                                    label: 'UI/Menu Color',
                                    submenu: [
                                        {
                                            label: 'Sync by Music thumbnail',
                                            type: 'radio',
                                            click: changecolorhandleClick
                                        },
                                        {
                                            label: 'Dark / Default',
                                            type: 'radio',
                                            checked: true,
                                            click: changecolorhandleClick
                                        }
                                    ]
                                },discordmenu
                            ]
                        }));
                    }

                    if (require('@electron/remote').app.isPackaged == true && areyouok.toLowerCase().includes('temp') != true && areyouok.toLowerCase().includes('snap') != true) {
                        menu.append(new MenuItem({
                            label: 'Help',
                            submenu: [
                                {
                                    label: 'Follow Us',
                                    click: async () => {
                                        const { shell } = require('electron')
                                        await shell.openExternal('https://www.facebook.com/QuadBCoder/')
                                    }
                                },
                                {
                                    label: 'Buy me a ko-fi',
                                    click: async () => {
                                        const { shell } = require('electron')
                                        await shell.openExternal('https://ko-fi.com/boyphongsakorn')
                                    }
                                },
                                { type: 'separator' },
                                {
                                    label: 'Report Bug/Issue',
                                    click: async () => {
                                        const { shell } = require('electron')
                                        await shell.openExternal('https://github.com/boyphongsakorn/saox/issues')
                                    }
                                },
                                {
                                    label: 'Discord Support/Report',
                                    click: async () => {
                                        await shell.openExternal('https://discord.gg/j7xce5hxUf')
                                    }
                                },
                                { type: 'separator' },
                                {
                                    label: 'About SAOX',
                                    click: async () => {
                                        const { shell } = require('electron')
                                        await shell.openExternal('https://quad-b.github.io/saox/')
                                    }
                                },
                                {
                                    label: 'Check for update....',
                                    click: async () => {
                                        ipcRenderer.send('checkdamnupdate');
                                    }
                                },
                                {
                                    label: 'Force update (Not recommend to use)',
                                    click: async () => {
                                        ipcRenderer.send('tryquitandupdate');
                                    }
                                },
                                { label: 'SAOX Version ' + require('@electron/remote').app.getVersion() }
                            ]
                        }));
                    } else {
                        menu.append(new MenuItem({
                            label: 'Help',
                            submenu: [
                                {
                                    label: 'Follow Us',
                                    click: async () => {
                                        const { shell } = require('electron')
                                        await shell.openExternal('https://www.facebook.com/QuadBCoder/')
                                    }
                                },
                                {
                                    label: 'Buy me a ko-fi',
                                    click: async () => {
                                        const { shell } = require('electron')
                                        await shell.openExternal('https://ko-fi.com/boyphongsakorn')
                                    }
                                },
                                { type: 'separator' },
                                {
                                    label: 'Report Bug/Issue',
                                    click: async () => {
                                        const { shell } = require('electron')
                                        await shell.openExternal('https://github.com/boyphongsakorn/saox/issues')
                                    }
                                },
                                {
                                    label: 'Discord Support/Report',
                                    click: async () => {
                                        await shell.openExternal('https://discord.gg/j7xce5hxUf')
                                    }
                                },
                                { type: 'separator' },
                                {
                                    label: 'About SAOX',
                                    click: async () => {
                                        const { shell } = require('electron')
                                        await shell.openExternal('https://quad-b.github.io/saox/')
                                    }
                                },
                                { label: 'SAOX Version ' + require('@electron/remote').app.getVersion() }
                            ]
                        }));
                    }
                } else {

                    try {
                        iframe.contentWindow.document.getElementById("watchonyoutube").outerHTML = "";
                    } catch (error) {

                    }
                    var div = document.createElement('div');
                    div.id = 'watchonyoutube';
                    div.innerHTML = '<div type="mini" class="sc-ckVGcZ fYXjSb"><a href="https://www.youtube.com/results?search_query=' + nearart + '%20' + elmnt + '&sp=CAM%253D' + '" target="_blank"><button font-size="1.3em" class="jHhvsM"><small>ดูวิดีโอเพลงนี้ใน Youtube</small><img src="https://boyphongsakorn.github.io/img/output-onlinepngtools.png"></button></a></div>';
                    div.className = 'sc-cvbbAY jRxSQj';

                    iframe.contentWindow.document.getElementsByClassName("sc-eHgmQL")[0].appendChild(div);
                    //iframe.contentWindow.document.getElementsByClassName("sc-eHgmQL")[0].innerHTML += "<div class=\"sc-cvbbAY jRxSQj\" id=\"watchonyoutube\"><div type=\"mini\" class=\"sc-ckVGcZ fYXjSb\"><a href=\"https://www.youtube.com/results?search_query=" + nearart + elmnt + '&sp=CAM%253D'+"\" target=\"_blank\"><button font-size=\"1.3em\" class=\"jHhvsM\"><small>ดูวิดีโอเพลงนี้ใน Youtube</small><img src=\"https://boyphongsakorn.github.io/img/output-onlinepngtools.png\"></button></a></div></div>"

                    menu.append(new MenuItem({
                        label: 'เมนูหลัก',
                        submenu: [
                            {
                                label: 'ดู เอ็มวี เพลงนี้',
                                click: async () => {
                                    await shell.openExternal('https://www.youtube.com/results?search_query=' + nearart + '%20' + elmnt + '&sp=CAM%253D')
                                }
                            },
                            {
                                label: 'ดาว์นโหลด เพลงนี้',
                                click: async () => {
                                    await shell.openExternal('https://mp3freefree.com/' + encodeURIComponent(nearart.replace("?", "")) + encodeURIComponent(elmnt.replace("?", "")) + '.html')
                                }
                            },
                            {
                                label: 'ปิดโปรแกรม',
                                click: async () => {
                                    window.close();
                                }
                            }
                        ]
                    }));

                    if (colorcustom == 'sync') {
                        menu.append(new MenuItem({
                            label: 'ตั้งค่า',
                            submenu: [
                                {
                                    label: 'ภาษา',
                                    submenu: [
                                        {
                                            label: 'ไทย',
                                            type: 'radio',
                                            checked: true,
                                            click: handleClick
                                        },
                                        {
                                            label: 'อังกฤษ',
                                            type: 'radio',
                                            click: handleClick
                                        }
                                    ]
                                },
                                {//#111111
                                    label: 'สีของเมนู',
                                    submenu: [
                                        {
                                            label: 'ซิงค์ตามภาพขนาดย่อของเพลง',
                                            type: 'radio',
                                            checked: true,
                                            click: changecolorhandleClick
                                        },
                                        {
                                            label: 'สีดำ',
                                            type: 'radio',
                                            click: changecolorhandleClick
                                        }
                                    ]
                                },discordmenu
                            ]
                        }));
                    } else {
                        menu.append(new MenuItem({
                            label: 'ตั้งค่า',
                            submenu: [
                                {
                                    label: 'ภาษา',
                                    submenu: [
                                        {
                                            label: 'ไทย',
                                            type: 'radio',
                                            checked: true,
                                            click: handleClick
                                        },
                                        {
                                            label: 'อังกฤษ',
                                            type: 'radio',
                                            click: handleClick
                                        }
                                    ]
                                },
                                {//#111111
                                    label: 'สีของเมนู',
                                    submenu: [
                                        {
                                            label: 'ซิงค์ตามภาพขนาดย่อของเพลง',
                                            type: 'radio',
                                            click: changecolorhandleClick
                                        },
                                        {
                                            label: 'สีดำ',
                                            type: 'radio',
                                            checked: true,
                                            click: changecolorhandleClick
                                        }
                                    ]
                                },discordmenu
                            ]
                        }));
                    }

                    if (require('@electron/remote').app.isPackaged == true && areyouok.toLowerCase().includes('temp') != true && areyouok.toLowerCase().includes('snap') != true) {
                        menu.append(new MenuItem({
                            label: 'ช่วยเหลือ',
                            submenu: [
                                {
                                    label: 'ติดตาม เฟสบุ๊ค',
                                    click: async () => {
                                        await shell.openExternal('https://www.facebook.com/QuadBCoder/')
                                    }
                                },
                                {
                                    label: 'สนับสนุน',
                                    click: async () => {
                                        await shell.openExternal('https://ko-fi.com/boyphongsakorn')
                                    }
                                },
                                { type: 'separator' },
                                {
                                    label: 'แจ้ง Bug',
                                    click: async () => {
                                        await shell.openExternal('https://github.com/boyphongsakorn/saox/issues')
                                    }
                                },
                                {
                                    label: 'ดิสคอร์ดสำหรับแจ้งปัญหา',
                                    click: async () => {
                                        await shell.openExternal('https://discord.gg/j7xce5hxUf')
                                    }
                                },
                                { type: 'separator' },
                                {
                                    label: 'เกี่ยวกับ SAOX',
                                    click: async () => {
                                        await shell.openExternal('https://quad-b.github.io/saox/')
                                    }
                                },
                                {
                                    label: 'ตรวจหาการอัปเดต',
                                    click: async () => {
                                        ipcRenderer.send('checkdamnupdate');
                                    }
                                },
                                {
                                    label: 'บังคับอัพเดต (ไม่แนะนำให้ใช้)',
                                    click: async () => {
                                        ipcRenderer.send('tryquitandupdate');
                                    }
                                },
                                { label: 'SAOX เวอร์ชั่น ' + require('@electron/remote').app.getVersion() }
                            ]
                        }));
                    } else {
                        menu.append(new MenuItem({
                            label: 'ช่วยเหลือ',
                            submenu: [
                                {
                                    label: 'ติดตาม เฟสบุ๊ค',
                                    click: async () => {
                                        await shell.openExternal('https://www.facebook.com/QuadBCoder/')
                                    }
                                },
                                {
                                    label: 'สนับสนุน',
                                    click: async () => {
                                        await shell.openExternal('https://ko-fi.com/boyphongsakorn')
                                    }
                                },
                                { type: 'separator' },
                                {
                                    label: 'แจ้ง Bug',
                                    click: async () => {
                                        await shell.openExternal('https://github.com/boyphongsakorn/saox/issues')
                                    }
                                },
                                {
                                    label: 'ดิสคอร์ดสำหรับแจ้งปัญหา',
                                    click: async () => {
                                        await shell.openExternal('https://discord.gg/j7xce5hxUf')
                                    }
                                },
                                { type: 'separator' },
                                {
                                    label: 'เกี่ยวกับ SAOX',
                                    click: async () => {
                                        await shell.openExternal('https://quad-b.github.io/saox/')
                                    }
                                },
                                { label: 'SAOX เวอร์ชั่น ' + require('@electron/remote').app.getVersion() }
                            ]
                        }));
                    }
                }

                //Menu.setApplicationMenu(menu)

                MyTitleBar.updateMenu(menu);

                /*if(iframe.contentWindow.document.getElementsByClassName('sc-bwzfXH fHRtps')[0].style.backgroundImage == ''){
                    var requestOptions = {
                        method: 'GET',
                        redirect: 'follow'
                    };

                    fetch("https://ytgif.pwisetthon.com/?name="+elmnt+"&art="+nearart, requestOptions)
                    .then(response => response.text())
                    .then(result => {
                        console.log(result)
                        //alert(elmnt)
                        //alert(nearart)
                        //alert(result)
                        if(result != ""){
                            iframe.contentWindow.document.getElementsByClassName('sc-bwzfXH fHRtps')[0].style.backgroundImage = "url("+result+")"
                            iframe.contentWindow.document.getElementsByClassName('sc-bwzfXH fHRtps')[0].style.backgroundPosition = "top"
                            iframe.contentWindow.document.getElementsByClassName('sc-bwzfXH fHRtps')[0].style.backgroundRepeat = "no-repeat"
                            iframe.contentWindow.document.getElementsByClassName('sc-bwzfXH fHRtps')[0].style.backgroundSize = "cover"
                            iframe.contentWindow.document.getElementsByClassName('sc-bwzfXH fHRtps')[0].style.filter = "brightness(0.5)"
                        }
                    })
                    .catch(error => console.log('error', error));
                }*/

                //$.get('https://pwisetthon.com/getcolor.php?url=' + image,  // url
                //    function (data, textStatus, jqXHR) {  // success callback
                    fac.getColorAsync(image)
                    .then(color => {
                        let data = color.hex
                            //container.style.backgroundColor = color.rgba;
                            //container.style.color = color.isDark ? '#fff' : '#000';

                        
                        document.title = nearart + ' : ' + elmnt
                        //iframe.contentWindow.document.getElementsByClassName('MainHeader')[0].style.backgroundColor = data
                        //iframe.contentWindow.document.getElementsByClassName('MainHeader')[0].style.filter = 'brightness(50%)'
                        if (colorcustom == 'sync') {
                            var n_match = ntc.name(data);
                            /*n_rgb = n_match[0]; // RGB value of closest match
                            n_name = n_match[1]; // Text string: Color name
                            n_exactmatch = n_match[2]; // True if exact color match*/
                            //alert(n_match);
                            sooxlogo = n_match[1].toLowerCase();
                            updatedl('notok')
                            MyTitleBar.updateBackground(customTitlebar.Color.fromHex(''+data));
                            let test = hexToRgbA(data)
                            let okithing = test.replace(/[\d\.]+\)$/g, "0.5")
                            //iframe.contentWindow.document.getElementsByClassName('sidebar')[0].style.backgroundColor = okithing
                            var frm = frames['iframe'].contentWindow.document;
                            var otherhead = frm.getElementsByTagName("head")[0];
                            var link = frm.createElement("style");
                            link.setAttribute("type", "text/css");
                            link.innerHTML = '.ScrollbarsCustom-Thumb{background: ' + data + ' !important;} .sidebar{background-color: ' + okithing + ') !important;} .MainHeader{background-color: ' + data + ' !important;}';
                            otherhead.appendChild(link);
                        } else {
                            sooxlogo = "joox";
                            MyTitleBar.updateBackground(customTitlebar.Color.fromHex('#111111'));
                            let test = hexToRgbA('#111111')
                            let okithing = test.replace(/[\d\.]+\)$/g, "1")
                            //iframe.contentWindow.document.getElementsByClassName('sidebar')[0].style.backgroundColor = okithing
                            var frm = frames['iframe'].contentWindow.document;
                            var otherhead = frm.getElementsByTagName("head")[0];
                            var link = frm.createElement("style");
                            link.setAttribute("type", "text/css");
                            link.innerHTML = '.ScrollbarsCustom-Thumb{background: #111111 !important;} .sidebar{background-color: ' + okithing + ') !important;} .MainHeader{background-color: #111111 !important;}';
                            otherhead.appendChild(link);
                        }
                        MyTitleBar.updateTitle(nearart + ' : ' + elmnt);
                        /*if (iframe.contentWindow.document.getElementById('menuzero') || iframe.contentWindow.document.getElementById('menuone')) {
                            iframe.contentWindow.document.getElementById('menuzero').style.background = data
                            iframe.contentWindow.document.getElementById('menuone').style.background = data
                            iframe.contentWindow.document.getElementById('menuzero').style.borderRadius = '6px'
                            iframe.contentWindow.document.getElementById('menuone').style.borderRadius = '6px'
                        } else {
                            iframe.contentWindow.document.getElementsByClassName('ScrollbarsCustom-Thumb ScrollbarsCustom-ThumbY')[0].style.background = data
                            iframe.contentWindow.document.getElementsByClassName('ScrollbarsCustom-Thumb ScrollbarsCustom-ThumbY')[0].id = 'menuzero'
                            iframe.contentWindow.document.getElementsByClassName('ScrollbarsCustom-Thumb ScrollbarsCustom-ThumbY')[0].className = ''
                            iframe.contentWindow.document.getElementsByClassName('ScrollbarsCustom-Thumb ScrollbarsCustom-ThumbY')[0].style.background = data
                            iframe.contentWindow.document.getElementsByClassName('ScrollbarsCustom-Thumb ScrollbarsCustom-ThumbY')[0].id = 'menuone'
                            iframe.contentWindow.document.getElementsByClassName('ScrollbarsCustom-Thumb ScrollbarsCustom-ThumbY')[0].className = ''
                        }*/
                        //console.log(iframe.contentWindow.document.getElementsByClassName('ScrollbarsCustom-Thumb ScrollbarsCustom-ThumbY')[1].style.background = data)
                        //iframe.contentWindow.document.getElementsByClassName('ScrollbarsCustom-Thumb ScrollbarsCustom-ThumbY')[0].className = ''
                        // console.log(iframe.contentWindow.document.getElementsByClassName('ScrollbarsCustom-Thumb ScrollbarsCustom-ThumbY')[1].style.background = data)
                        //console.log('Average color', color);
                    })
                    .catch(e => {
                        //console.log(e);
                    });
                //});
            } else {
                if (document.title == 'SAOX' && ok == 'notok') {
                    const menu = new Menu();

                    if (language == 'en') {
                        menu.append(new MenuItem({
                            label: 'File',
                            submenu: [
                                {
                                    label: 'Exit/Close',
                                    click: async () => {
                                        window.close();
                                    }
                                }
                            ]
                        }));

                        if (colorcustom == 'sync') {
                            menu.append(new MenuItem({
                                label: 'Settings',
                                submenu: [
                                    {
                                        label: 'Select Languages',
                                        submenu: [
                                            {
                                                label: 'Thai',
                                                type: 'radio',
                                                click: handleClick
                                            },
                                            {
                                                label: 'English',
                                                type: 'radio',
                                                checked: true,
                                                click: handleClick
                                            },
                                            {
                                                label: 'More Soon...'
                                            }
                                        ]
                                    },
                                    {//#111111
                                        label: 'UI/Menu Color',
                                        submenu: [
                                            {
                                                label: 'Sync by Music thumbnail',
                                                type: 'radio',
                                                checked: true,
                                                click: changecolorhandleClick
                                            },
                                            {
                                                label: 'Dark / Default',
                                                type: 'radio',
                                                click: changecolorhandleClick
                                            }
                                        ]
                                    },discordmenu
                                ]
                            }));
                        } else {
                            menu.append(new MenuItem({
                                label: 'Settings',
                                submenu: [
                                    {
                                        label: 'Select Languages',
                                        submenu: [
                                            {
                                                label: 'Thai',
                                                type: 'radio',
                                                click: handleClick
                                            },
                                            {
                                                label: 'English',
                                                type: 'radio',
                                                checked: true,
                                                click: handleClick
                                            },
                                            {
                                                label: 'More Soon...'
                                            }
                                        ]
                                    },
                                    {//#111111
                                        label: 'UI/Menu Color',
                                        submenu: [
                                            {
                                                label: 'Sync by Music thumbnail',
                                                type: 'radio',
                                                click: changecolorhandleClick
                                            },
                                            {
                                                label: 'Dark / Default',
                                                type: 'radio',
                                                checked: true,
                                                click: changecolorhandleClick
                                            }
                                        ]
                                    },discordmenu
                                ]
                            }));
                        }

                        if (require('@electron/remote').app.isPackaged == true && areyouok.toLowerCase().includes('temp') != true && areyouok.toLowerCase().includes('snap') != true) {
                            menu.append(new MenuItem({
                                label: 'Help',
                                submenu: [
                                    {
                                        label: 'Follow Us',
                                        click: async () => {
                                            const { shell } = require('electron')
                                            await shell.openExternal('https://www.facebook.com/QuadBCoder/')
                                        }
                                    },
                                    {
                                        label: 'Buy me a ko-fi',
                                        click: async () => {
                                            const { shell } = require('electron')
                                            await shell.openExternal('https://ko-fi.com/boyphongsakorn')
                                        }
                                    },
                                    { type: 'separator' },
                                    {
                                        label: 'Report Bug/Issue',
                                        click: async () => {
                                            const { shell } = require('electron')
                                            await shell.openExternal('https://github.com/boyphongsakorn/saox/issues')
                                        }
                                    },
                                    {
                                        label: 'Discord Support/Report',
                                        click: async () => {
                                            await shell.openExternal('https://discord.gg/j7xce5hxUf')
                                        }
                                    },
                                    { type: 'separator' },
                                    {
                                        label: 'About SAOX',
                                        click: async () => {
                                            const { shell } = require('electron')
                                            await shell.openExternal('https://quad-b.github.io/saox/')
                                        }
                                    },
                                    {
                                        label: 'Check for update...',
                                        click: async () => {
                                            ipcRenderer.send('checkdamnupdate');
                                        }
                                    },
                                    {
                                        label: 'Force update (Not recommend to use)',
                                        click: async () => {
                                            ipcRenderer.send('tryquitandupdate');
                                        }
                                    },
                                    { label: 'SAOX Version ' + require('@electron/remote').app.getVersion() }
                                ]
                            }));
                        } else {
                            menu.append(new MenuItem({
                                label: 'Help',
                                submenu: [
                                    {
                                        label: 'Follow Us',
                                        click: async () => {
                                            const { shell } = require('electron')
                                            await shell.openExternal('https://www.facebook.com/QuadBCoder/')
                                        }
                                    },
                                    {
                                        label: 'Buy me a ko-fi',
                                        click: async () => {
                                            const { shell } = require('electron')
                                            await shell.openExternal('https://ko-fi.com/boyphongsakorn')
                                        }
                                    },
                                    { type: 'separator' },
                                    {
                                        label: 'Report Bug/Issue',
                                        click: async () => {
                                            const { shell } = require('electron')
                                            await shell.openExternal('https://github.com/boyphongsakorn/saox/issues')
                                        }
                                    },
                                    {
                                        label: 'Discord Support/Report',
                                        click: async () => {
                                            await shell.openExternal('https://discord.gg/j7xce5hxUf')
                                        }
                                    },
                                    { type: 'separator' },
                                    {
                                        label: 'About SAOX',
                                        click: async () => {
                                            const { shell } = require('electron')
                                            await shell.openExternal('https://quad-b.github.io/saox/')
                                        }
                                    },
                                    { label: 'SAOX Version ' + require('@electron/remote').app.getVersion() }
                                ]
                            }));
                        }
                    } else {
                        menu.append(new MenuItem({
                            label: 'เมนูหลัก',
                            submenu: [
                                {
                                    label: 'ปิดโปรแกรม',
                                    click: async () => {
                                        window.close();
                                    }
                                }
                            ]
                        }));

                        if (colorcustom == 'sync') {
                            menu.append(new MenuItem({
                                label: 'ตั้งค่า',
                                submenu: [
                                    {
                                        label: 'ภาษา',
                                        submenu: [
                                            {
                                                label: 'ไทย',
                                                type: 'radio',
                                                checked: true,
                                                click: handleClick
                                            },
                                            {
                                                label: 'อังกฤษ',
                                                type: 'radio',
                                                click: handleClick
                                            }
                                        ]
                                    },
                                    {//#111111
                                        label: 'สีของเมนู',
                                        submenu: [
                                            {
                                                label: 'ซิงค์ตามภาพขนาดย่อของเพลง',
                                                type: 'radio',
                                                checked: true,
                                                click: changecolorhandleClick
                                            },
                                            {
                                                label: 'สีดำ',
                                                type: 'radio',
                                                click: changecolorhandleClick
                                            }
                                        ]
                                    },discordmenu
                                ]
                            }));
                        } else {
                            menu.append(new MenuItem({
                                label: 'ตั้งค่า',
                                submenu: [
                                    {
                                        label: 'ภาษา',
                                        submenu: [
                                            {
                                                label: 'ไทย',
                                                type: 'radio',
                                                checked: true,
                                                click: handleClick
                                            },
                                            {
                                                label: 'อังกฤษ',
                                                type: 'radio',
                                                click: handleClick
                                            }
                                        ]
                                    },
                                    {//#111111
                                        label: 'สีของเมนู',
                                        submenu: [
                                            {
                                                label: 'ซิงค์ตามภาพขนาดย่อของเพลง',
                                                type: 'radio',
                                                click: changecolorhandleClick
                                            },
                                            {
                                                label: 'สีดำ',
                                                type: 'radio',
                                                checked: true,
                                                click: changecolorhandleClick
                                            }
                                        ]
                                    },discordmenu
                                ]
                            }));
                        }

                        if (require('@electron/remote').app.isPackaged == true && areyouok.toLowerCase().includes('temp') != true && areyouok.toLowerCase().includes('snap') != true) {
                            menu.append(new MenuItem({
                                label: 'ช่วยเหลือ',
                                submenu: [
                                    {
                                        label: 'ติดตาม เฟสบุ๊ค',
                                        click: async () => {
                                            const { shell } = require('electron')
                                            await shell.openExternal('https://www.facebook.com/QuadBCoder/')
                                        }
                                    },
                                    {
                                        label: 'สนับสนุน',
                                        click: async () => {
                                            const { shell } = require('electron')
                                            await shell.openExternal('https://ko-fi.com/boyphongsakorn')
                                        }
                                    },
                                    { type: 'separator' },
                                    {
                                        label: 'แจ้ง Bug',
                                        click: async () => {
                                            const { shell } = require('electron')
                                            await shell.openExternal('https://github.com/boyphongsakorn/saox/issues')
                                        }
                                    },
                                    {
                                        label: 'ดิสคอร์ดสำหรับแจ้งปัญหา',
                                        click: async () => {
                                            await shell.openExternal('https://discord.gg/j7xce5hxUf')
                                        }
                                    },
                                    { type: 'separator' },
                                    {
                                        label: 'เกี่ยวกับ SAOX',
                                        click: async () => {
                                            const { shell } = require('electron')
                                            await shell.openExternal('https://quad-b.github.io/saox/')
                                        }
                                    },
                                    {
                                        label: 'ตรวจหาการอัปเดต',
                                        click: async () => {
                                            ipcRenderer.send('checkdamnupdate');
                                        }
                                    },
                                    {
                                        label: 'บังคับอัพเดต (ไม่แนะนำให้ใช้)',
                                        click: async () => {
                                            ipcRenderer.send('tryquitandupdate');
                                        }
                                    },
                                    { label: 'SAOX เวอร์ชั่น ' + require('@electron/remote').app.getVersion() }
                                ]
                            }));
                        } else {
                            menu.append(new MenuItem({
                                label: 'ช่วยเหลือ',
                                submenu: [
                                    {
                                        label: 'ติดตาม เฟสบุ๊ค',
                                        click: async () => {
                                            const { shell } = require('electron')
                                            await shell.openExternal('https://www.facebook.com/QuadBCoder/')
                                        }
                                    },
                                    {
                                        label: 'สนับสนุน',
                                        click: async () => {
                                            const { shell } = require('electron')
                                            await shell.openExternal('https://ko-fi.com/boyphongsakorn')
                                        }
                                    },
                                    { type: 'separator' },
                                    {
                                        label: 'แจ้ง Bug',
                                        click: async () => {
                                            const { shell } = require('electron')
                                            await shell.openExternal('https://github.com/boyphongsakorn/saox/issues')
                                        }
                                    },
                                    {
                                        label: 'ดิสคอร์ดสำหรับแจ้งปัญหา',
                                        click: async () => {
                                            await shell.openExternal('https://discord.gg/j7xce5hxUf')
                                        }
                                    },
                                    { type: 'separator' },
                                    {
                                        label: 'เกี่ยวกับ SAOX',
                                        click: async () => {
                                            const { shell } = require('electron')
                                            await shell.openExternal('https://quad-b.github.io/saox/')
                                        }
                                    },
                                    { label: 'SAOX เวอร์ชั่น ' + require('@electron/remote').app.getVersion() }
                                ]
                            }));
                        }
                    }

                    MyTitleBar.updateMenu(menu);

                    MyTitleBar.updateTitle('SAOX');

                    //Menu.setApplicationMenu(menu)

                    document.title = 'SAOX'
                }
            }

        }

    </script>

</body>

</html>